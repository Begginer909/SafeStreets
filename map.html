<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" /> 

    <!--Directory ko ito kung saan nakalagay yung bootstrap ko. Papalitan nalang ng link ng bootstrap online-->

</head>

<body>

    <nav class="navbar navbar-expand-md" style="background-color: #1f497d; height: 100%">
        <div class="container-fluid">
            <button class="navbar-toggler bg-light border-light" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="row mx-auto">
                <a class="image" href="admin.html">
                    <img src="Logo.png" safestreet_logo" class="img-fluid" width="150px" height="60">
                </a>
            </div>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav fs-3">
                    <li class="selectedItem nav-item border-responsive">
                        <a class="nav-link text-light" name="Home" aria-current="true" href="home.html">Home</a>
                    </li>
                    <li class="selectedItem nav-item  border-responsive active">
                        <a class="nav-link text-light" name="mapView" href="map.html">Map View</a>
                    </li>
                    <li class="selectedItem nav-item  border-responsive">
                        <a class="nav-link text-light" name="createReport" href="createReport.html">Create Report</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid ">
        <div class="map col-12 mt-3">
            <div id="map"></div>

            <input type="text" id="inputColor" placeholder="Please input the street and color" style="width: 300px">
            <button onclick="updateColors()">Confirm</button>
        </div>
        <div class="col-12">
            <canvas id="myChart"></canvas>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        const ctx = document.getElementById('myChart');
        
        const myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'],
                datasets: [{
                    label: 'Numbers of Report',
                    data: [12, 19, 3, 5, 2, 3, 5],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                },
                onClick: (event) => {
                    const activePoints = myChart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, false);
                    if (activePoints.length) {
                        const clickedIndex = activePoints[0].index;
                        const label = myChart.data.labels[clickedIndex];
                        const value = myChart.data.datasets[0].data[clickedIndex];
                        alert(`Clicked on ${label}: ${value}`);
                    }
                }
            }
        });
    </script>
        

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Initialize the map
        var map = L.map('map').setView([14.358083677714449, 121.0583616614907], 19);

        // Add a tile layer (you can use different tile providers)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Create circles with default colors
        var circleStreet4th = L.circle([14.358169425879144, 121.05766965157575], {
            color: 'transparent',
            fillColor: 'red', // Default color
            fillOpacity: 0.5,
            radius: 30
        }).addTo(map);

        var circleStreet5th = L.circle([14.358366906376673, 121.05825437313592], {
            color: 'transparent',
            fillColor: 'red', // Default color
            fillOpacity: 0.5,
            radius: 30
        }).addTo(map);


        var circleStreet2nd = L.circle([14.357803047123392, 121.05888201004971], {
            color: 'transparent',
            fillColor: 'red', // Default color
            fillOpacity: 0.5,
            radius: 30
        }).addTo(map);

        function updateColors() {
            var inputColor = document.getElementById("inputColor").value.toLowerCase();

            // Update the fill color of circles based on input
            if (inputColor === "4th blue") {
                circleStreet4th.setStyle({ fillColor: 'blue' });
            } else if (inputColor === "5th blue") {
                circleStreet5th.setStyle({ fillColor: 'blue' });
            } else if (inputColor === "2nd blue") {
                circleStreet2nd.setStyle({ fillColor: 'blue' });
            }
        }

        const eventHandler = {
            map: map,
            handleClick: function(e) {
                console.log('Map clicked at:', e.latlng)
            }
        };
        
        //L.DomEvent.on(map, 'click', eventHandler.handleClick);

        const person = {
            name: "Mark Louie Narvasa",
            age: 21,
            gender: "male", 
            testClick: function(mousemove){
                console.log("Hello this is " + this.name);
            }

        };

        const person2 = {
            name: "Kyla Marie Narvasa",
            age: 18,
            gender: "female"
        };


        const eventHandlers = {
            handleClick: function(e) {
                console.log("Button clicked! This refers to:", this);
            },
            handleMouseOver: function(e) {
                console.log("Mouse over button! This refers to:", this);
            },
            handleOnMouseOver: function(e){
                console.log("Location is: ", e.latlng);
            }
        };

        // Define a context object
        const contextObject = {
            contextName: 'Context Object',
        };

        // Custom `on` function to attach multiple event handlers
        function on(el, eventMap, context) {
            for (let [eventType, handler] of Object.entries(eventMap)) {
                el.addEventListener(eventType, handler.bind(context));
            }
        }

        // Use the custom `on` function to attach event handlers
        on(map, {
            click: eventHandlers.handleClick,
            mouseover: eventHandlers.handleMouseOver,
            onclick: eventHandlers.handleOnMouseOver,
        }, contextObject);


    </script>

    <script src="bootstrap/js/bootstrap.js"></script>
    <!--Directory ko ito kung saan nakalagay yung bootstrap ko. Papalitan nalang ng link ng bootstrap online-->
    <script src="script.js"></script>
</body>

</html>